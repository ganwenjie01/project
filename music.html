<!DOCTYPE html>
<html>
	<head>
		<meta charset="UTF-8">
		<meta name="viewport" content="width=device-width,initial-scale=1,minimum-scale=1,maximum-scale=1,user-scalable=no" />
		<link rel="stylesheet" type="text/css" href="css/music.css"/>
		<link rel="stylesheet" type="text/css" href="//at.alicdn.com/t/font_650603_ogef7yhovexnipb9.css"/>
		<title></title>
		
	</head>
	<body>
<!--	//广告界面-->
		<div class="push-logo">
		    <div class="push-logo-img">
		    <img src="img/logo.jpg" alt="" />
		    </div>
		    <div class="push-logo-word">
		    	 <span>音乐改变生活</span>
		    </div>
		    <div class="push-logo-footer">
		    	 <div class="push-logo-footer-img">
		    	 	<img src="img/music.png" alt="" />
		    	 </div>
		    	  <div class="push-logo-footer-word">
		    	  	<span>@gwj.music版权所有</span>
		    	  </div>
		    </div>
		</div>
		
		
		
<!--		//内容app-->
          <div class="container">
          	
        
          	<!--主体部分-->
          	<header>
          		<div class="header-top">
          			<div class="iconfont icon-htmal5icon35">
          			</div>
          			<div> 
          			<input type="text" placeholder="歌曲 、歌手、专辑、歌词" class="header-top-input"/>
          			   <div>
          			   	<div class="header-top-danqu">
          			   		<p class="header-top-public-p"><span class="iconfont icon-yinle"></span>单曲</p>
          			   	<ul class="header-top-ul-danqu">
          			   		 
          			   	</ul>
          			   	</div>
          			   	
          			   	<div class="header-top-geshou">
          			   		
          			   	</div>
          			   	
          			   	<div class="header-top-zhuanji">
          			   		<p class="header-top-public-p"><span class="iconfont icon-zhuanjiguangpan"></span>专辑</p>
          			   		<ul class="header-top-ul-zhuanji">
          			   			
          			   		</ul>
          			   		
          			   	</div>
          			   	
          			   		<div class="header-top-mv">
          			   		
          			     	</div>
          			   
          			   </div>
          			   
          			
          			</div>
          			<div class="iconfont icon-sousuo search-btn"> </div>
          		  </div>
          		  <!--登录界面-->
          		  <div class="header-log"> 
          				<div class="header-log-top">
          					<span>登录能享受更多无损音乐哦!</span>
          					<button class="header-log-button">立即登陆</button>
          				</div>
          				<div class="header-log-center">
          					 <ul>
          					 	<li> <span class="iconfont icon-zhuye"></span>我的主页</li>
          					 	<li><span class="iconfont icon-haoyou"></span>我的好友</li>
          					 	<li><span class="iconfont icon-vip"></span>我的vip</li>
          					 	<li><span class="iconfont icon-xiaoxi"></span>我的消息</li>
          					 </ul>
          				</div>
          				<div class="header-footer">
          					 <div><span class="iconfont icon-shezhi"></span> <span>设置</span></div>
          					 <div><span>退出</span></div>
          				</div>
          				
          	       </div>
          			
          	</header>
          	<section>
          <!--热门单曲-->
           <div class="section-value">
          	    <div class="section-value-houstsong">
          	    	 <p><span class="iconfont icon-yinle1"><span>热门新歌</p>
          	         <ul class="section-value-houstsong-ul"></ul>
          	    </div>
          	
           </div>
          		 
          	</section>
          	
          	
        <!--  	底部-->
          	<footer>
          		<div class="footer-player">
          			<div class="footer-player-auto">
          			<audio  src='' autoplay="autoplay">
          				
          		    <source src=""> </source>
          			</audio>
          			</div>
          			<div class="footer-player-cover">
                     <img src="" class="footer-player-cover-img" />
                 <!--    .attr('src','')-->
          			</div>
          			
          			<div class="footer-player-songname">
          				 <span class="footer-player-songname-name">好久鼻尖</span>
          			<!--	 <p class="footer-player-songname-singname">你好啊</p>-->
          			</div>
          			
          <div class="footer-player-begin">
          		<button class="iconfont icon-kaishi btn"></button>
             </div>
          		</div>
          		 
          	</footer>
          	
          	
          	
       <!--   	歌曲详情-->  
           <div class="container-song-details">
       	             <div class="container-song-top">
       	             	 <div class="container-song-top-return">
       	             	 	<span class="iconfont icon-zuohua ruturn"></span>
       	             	 </div>
       	             	 <img src="" alt="" />
       	               </div>
       	               <div class="container-song-conter">
       	               </div>
       	   
       	          <div class="container-song-footer">
       	          	 <span class="iconfont icon-shangyishou" ></span>
       	          	 <span class="iconfont icon-kaishi badge"></span>
       	          	 <span class="iconfont icon-kuaijin"></span>
       	          </div>
       	
       	
                   </div>
       
       </div> 
                 
                 
      
	</body>
	<script type="text/javascript" src="js/zepto.js"></script>
    <script type="text/javascript" src="js/event.js"></script>
	<script type="text/javascript" src="js/touch.js"></script>
	<script type="text/javascript" src="js/fx.js"></script>
	<script type="text/javascript" src="js/jquery-3.2.1.js"></script>
	
	<script type="text/javascript" charset="UTF-8">
    document.documentElement.style.fontSize = document.documentElement.clientWidth / 10 + 'px';	
		//点击logo消失
	 var logF=$('.push-logo') 
	    $(document).ready(function(){//页面加载完之后，自动执行该方法
        setTimeout(function(){
      	logF.fadeOut();
        $('.container').css('display','block')
      },2000);//2秒后执行该方法
     });
   //搜索
     var menu=$('.header-top').children().eq(0)
     console.log(menu)
      menu.click(function(){
      	 $('.header-log').animate({left:0},1000);
      })
  //划入
     window.$$=window.Zepto = Zepto
	$$('.header-log').swipeLeft(function(){
         $('.header-log').animate({left:-5.3+'rem'},1000);
		console.log('left')
	})	
//登录页面
$('.header-log-button').click(function(){
	window.location.href='login.html'
	
})
//搜索歌曲
//  var ull=$('.header-top-ul')
  var arr=[];
 $('.header-top-input').keyup(function(){
 	$('.section-value').css('display','none')
 	var val=$('.header-top-input').val()
 	console.log(val)
 	$('.header-top-public-p').css('display','block')
 	$.ajax({
 		type:"post",
 		url:'https://c.y.qq.com/soso/fcgi-bin/client_search_cp?ct=24&qqmusic_ver=1298&new_json=1&remoteplace=txt.yqq.song&searchid=68118207120605907&t=0&aggr=1&cr=1&catZhida=1&lossless=0&flag_qc=0&w='+val+'&g_tk=5381&jsonpCallback=searchCallbacksong5453&loginUin=0&hostUin=0&format=jsonp&inCharset=utf8&outCharset=utf-8&notice=0&platform=yqq&needNewCode=0',
 		dataType:'jsonp',
   		jsonpCallback:'searchCallbacksong5453'
 	}).done(function(data){
 	     $('ul').empty()
   		 console.log(data.data)
 	  for(var i in data.data){

 	//专辑
 	
   	for(var k in data.data[i].list){

   		for(var t in data.data[i].list[k].singer){
// 			console.log(data.data[i].list[k].singer[t].name)
   			var lis='<li>'+data.data[i].list[k].album.name+"<span class='code'>"+'-'+data.data[i].list[k].singer[t].name+'</span></li>'

		       $('.header-top-ul-zhuanji').append($(lis))
   		}
       
   	}

// 	
   	
// 	单曲
   		 for(var k in data.data[i]){
// 		 	console.log(data.data[i][k])
// 		 	console.log(data.data[i][k].singerName)
        for(var f in data.data[i][k].hotsong){
//      	console.log(data.data[i][k].singerPic.split('/'))
//      	 console.log(data.data[i][k].hotsong[f].songName);
        	 console.log(data.data[i][k].hotsong[f].songMID)
        	  console.log(data.data[i][k].hotsong[f].songID)

       
//      	  console.log(data.data[i][k].hotsong[f].songID)
          var li='<li>'+data.data[i][k].hotsong[f].songName+"<span>"+'-'+data.data[i][k].singerName+'</span><span>-'+ data.data[i][k].hotsong[f].songMID+'</span></li>';	
			     $('.header-top-ul-danqu').append($(li))
			  for(var j=0;j<$('.header-top-ul-danqu li').length;j++){
//	                       console.log(j)
//               var $('.header-top-ul-danqu li')[j].index()=$(this).index() 

			 	     
            $('.header-top-ul-danqu>li')[j].addEventListener('touchstart',function(){

                             
		  	                 console.log($(this).text().split('-')[2])
//		  	                 
			 	$('.footer-player-songname-name').html($(this).text().split('-')[0])
//	
                $('.footer-player-cover-img').attr('src','http://i.gtimg.cn/music/photo/mid_singer_180/'+data.data[i][k].singerPic.split('/')[6]+'/'+data.data[i][k].singerPic.split('/')[7]+'/'+data.data[i][k].singerPic.split('/')[8])
                 $('.container-song-top>img').attr('src','http://i.gtimg.cn/music/photo/mid_singer_180/'+data.data[i][k].singerPic.split('/')[6]+'/'+data.data[i][k].singerPic.split('/')[7]+'/'+data.data[i][k].singerPic.split('/')[8])
              
               var  mid =$(this).text().split('-')[2]
               console.log(mid)
                 getMusic(mid)
                 
             //歌词    
//               var Base64={_keyStr:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",encode:function(e){var t="";var n,r,i,s,o,u,a;var f=0;e=Base64._utf8_encode(e);while(f<e.length){n=e.charCodeAt(f++);r=e.charCodeAt(f++);i=e.charCodeAt(f++);s=n>>2;o=(n&3)<<4|r>>4;u=(r&15)<<2|i>>6;a=i&63;if(isNaN(r)){u=a=64}else if(isNaN(i)){a=64}t=t+this._keyStr.charAt(s)+this._keyStr.charAt(o)+this._keyStr.charAt(u)+this._keyStr.charAt(a)}return t},decode:function(e){var t="";var n,r,i;var s,o,u,a;var f=0;e=e.replace(/[^A-Za-z0-9+/=]/g,"");while(f<e.length){s=this._keyStr.indexOf(e.charAt(f++));o=this._keyStr.indexOf(e.charAt(f++));u=this._keyStr.indexOf(e.charAt(f++));a=this._keyStr.indexOf(e.charAt(f++));n=s<<2|o>>4;r=(o&15)<<4|u>>2;i=(u&3)<<6|a;t=t+String.fromCharCode(n);if(u!=64){t=t+String.fromCharCode(r)}if(a!=64){t=t+String.fromCharCode(i)}}t=Base64._utf8_decode(t);return t},_utf8_encode:function(e){e=e.replace(/rn/g,"n");var t="";for(var n=0;n<e.length;n++){var r=e.charCodeAt(n);if(r<128){t+=String.fromCharCode(r)}else if(r>127&&r<2048){t+=String.fromCharCode(r>>6|192);t+=String.fromCharCode(r&63|128)}else{t+=String.fromCharCode(r>>12|224);t+=String.fromCharCode(r>>6&63|128);t+=String.fromCharCode(r&63|128)}}return t},_utf8_decode:function(e){var t="";var n=0;var r=c1=c2=0;while(n<e.length){r=e.charCodeAt(n);if(r<128){t+=String.fromCharCode(r);n++}else if(r>191&&r<224){c2=e.charCodeAt(n+1);t+=String.fromCharCode((r&31)<<6|c2&63);n+=2}else{c2=e.charCodeAt(n+1);c3=e.charCodeAt(n+2);t+=String.fromCharCode((r&15)<<12|(c2&63)<<6|c3&63);n+=3}}return t}} 	
//              var geci="http://c.y.qq.com/lyric/fcgi-bin/fcg_query_lyric.fcg?g_tk=1528318272&uin=903019458&format=json&inCharset=utf-8&outCharset=utf-8&notice=0&platform=h5&needNewCode=1&nobase64=1&musicid=212130609&songtype=0&_=1526987477452&jsonpCallback=jsonp1"
//              var decodedString = Base64.decode(geci)	
//           	 console.log(decodedString)
//               var dizhi=data.data[i][k].hotsong[f].songID
//               console.log(dizhi)
//              $.ajax({
//           	type:"get",
//           	url:'decodedString',
////           	url:'https://c.y.qq.com/lyric/fcgi-bin/fcg_query_lyric.fcg?nobase64=1&musicid='+dizhi+'&callback=jsonp1&g_tk=5381&jsonpCallback=jsonp1&loginUin=0&hostUin=0&format=jsonp&inCharset=utf8&outCharset=utf-8&notice=0&platform=yqq&needNewCode=0',
//           	dataType:'jsonp',
//           	jsonpCallback: 'jsonp1',
//           	callback:'jsonp1',
//           	outCharset:'utf-8'
//              }).done(function(data){
//             console.log(data)
//           	
//           });
//     
			 })	  

		}
      }
   }
 }
});
 	
 })
 
 
		
     $("body").keydown(function() {
             if (event.keyCode == "13") {//keyCode=13是回车键
                $('.search-btn').click();
             }
         });
	
	//点击播放、暂停
	 var flag=false;
	 var ad=$('audio');
     $('.btn').click(function(){
           fn()
           $('.btn').toggleClass('zanting')
//           $('.badge').toggleClass('kaishi')
           })
     $('.badge').click(function(){
            fn()
            $('.badge').toggleClass('zanting')
//          $('.badge').toggleClass('kaishi')
           })

 //点击封装
           function fn(){
          	if(flag){
               ad[0].pause();
           	    flag=false;
        	   }else{
        	 	ad[0].play();
        	 	flag=true;
           	}
          	
          }
    
    //歌曲详情
    
    $('.footer-player').click(function(){
    	console.log(1)
    	$('.container-song-details').animate({top:0},500)
    		
    })
    
	 $('.ruturn').click(function(){
	 	 console.log(2)
     $('.container-song-details').animate({top:17.7866666666+'rem'},500)	
	})
	 
	//热门单曲 
	$(document).ready(function(){  
		
		 $.ajax({
		 	type:"get",
		 	url:"https://c.y.qq.com/v8/fcg-bin/fcg_v8_toplist_cp.fcg?tpl=3&page=detail&date=2018-05-18&topid=27&type=top&song_begin=0&song_num=30&g_tk=5381&jsonpCallback=MusicJsonCallbacktoplist&loginUin=0&hostUin=0&format=jsonp&inCharset=utf8&outCharset=utf-8&notice=0&platform=yqq&needNewCode=0",
		 	dataType:'jsonp',
		 	jsonpCallback:'MusicJsonCallbacktoplist'
		 }).done(function(data){
		 	console.log(data)

		 	$.each(data.songlist, function(i,v) {
		    var songids=v.data.songmid
		    var songli=v.data.albumname;
		    var albummid=v.data.albummid
		    $.each(v.data.singer,function(i,v){
		    	 console.log(v.name)
		    	var li='<li><span class="iconfont icon-yinle01"></span><span>'+songli+'</span>--<p>'+v.name+'</p><span>-'+ songids+'</span><span>-'+albummid+'</span></li>'
		 	for(var k=0;k<$('.section-value-houstsong-ul li').length;k++){
		 		
		 		$('.section-value-houstsong-ul>li')[k].addEventListener('touchstart',function(e){
                    console.log($('audio').currentTime)	 		    
                    console.log(albummid)
		 			 console.log($(this).text())
		 		     console.log($(this).text().split('-'))
                
                  var mids=$(this).text().split('-')[3]
                   console.log(mids)
                $('.footer-player-cover-img').attr('src','https://y.gtimg.cn/music/photo_new/T002R90x90M000'+$(this).text().split('-')[4]+'.jpg?max_age=2592000')
			 	$('.footer-player-songname-name').html($(this).text().split('-')[0])
                $('.container-song-top>img').attr('src','https://y.gtimg.cn/music/photo_new/T002R90x90M000'+$(this).text().split('-')[4]+'.jpg?max_age=2592000')             
                   getMusic(mids)
              console.log($('audio').currentTime)
		 		})
		 	}

		 	$('.section-value-houstsong-ul').append(li)		
		   })	
		 	});
		 })
		} )
	//播放音乐封装
	    function getMusic(way){
          $.ajax({
		 			type:"get",
		 			url:"http://c.y.qq.com/base/fcgi-bin/fcg_musicexpress.fcg?json=3&guid=0",
		 			dataType:'jsonp',
                    jsonpCallback:'jsonCallback'
		 		 }).done(function(data){
		 	      var ckey=data.key;
               	  console.log(ckey)	
		 			
		 			 $('audio').attr('src','http://dl.stream.qqmusic.qq.com/C400'+way+'.m4a?vkey='+ckey+'&guid=0&uin=903019458&fromtag=38');
               	    $('source').attr('src','http://dl.stream.qqmusic.qq.com/C400'+way+'.m4a?vkey='+ckey+'&guid=0&uin=903019458&fromtag=38');
//		 	         console.log($('audio').currentTime);
		 		 });
	 }
	
	 
	</script>
</html>
